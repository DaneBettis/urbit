<!doctype html>
<html>
  <head>
    <title>Step 3</title>
  </head>
  <body>
    <h1>Probably Successful!</h1>
    <script type="text/javascript">
      let params = (new URL(document.location)).searchParams;
      let tokenId = params.get('token-id');
      let data = `
        <complete-action>
          <api-key>2F822Rw39fx762MaV7Yy86jXGTC7sCDy</api-key>
          <token-id>${tokenId}</token-id>
        </complete-action>
      `;

      fetch('https://secure.networkmerchants.com/api/v2/three-step', {
        method: 'POST',
        headers: {
          'Content-type': 'text/xml'
        },
        body: data
      }).then(response => response.text())
        .then(result => {
          console.log('Success:', result);
        })
        .catch(error => {
          console.error('Error:', error);
        });
    </script>
  </body>
</html>
